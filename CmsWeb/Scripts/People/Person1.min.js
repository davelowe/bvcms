function RebindMemberGrids(){$.updateTable($("#current-tab form")),$.updateTable($("#pending-tab form")),$("#memberDialog").dialog("close")}function RebindUserInfoGrid(){$.updateTable($("#user-tab form")),$("#memberDialog").dialog("close")}function dialogError(n){return n}$(function(){var n,t,i,u,r;$("#split").live("click",function(n){n.preventDefault();var t=$(this).attr("href");bootbox.confirm("Are you sure you want to split this person into their own family?",function(n){n===!0&&$.post(t,{},function(n){window.location=n})})}),$("#deletePerson").live("click",function(n){n.preventDefault();var t=$(this).attr("href");bootbox.confirm("Are you sure you want to delete this record?",function(n){n===!0&&$.post(t,{},function(n){window.location=n})})}),$("#search-add a.commit").live("click",function(n){n.preventDefault();var t=$(this).closest("form"),i=t.serialize(),r=$(this).attr("href");return $.post(r,i,function(n){if(t.modal("hide"),n.message)alert(n.message);else switch(n.from){case"RelatedFamily":$("#related-families-div").loadWith("/Person2/RelatedFamilies/"+n.pid,function(){$(n.key).click()});break;case"Family":$("#family-div").loadWith("/Person2/FamilyMembers/"+n.pid);break;case"Menu":window.location="/Person2/"+n.pid;break;case"MergeTo":window.location="/Manage/Merge?PeopleId1="+n.pid+"&PeopleId2="+n.pid2}}),!1}),$("a.editaddr").live("click",function(n){n.preventDefault(),$("#edit-address").css({"margin-top":"",top:""}).load($(this).attr("href"),{},function(){var n=$(this);n.modal("show");n.on("hidden",function(){$(this).empty()});n.on("click","a.close-saved-address",function(){$.post($(this).attr("href"),{},function(n){$("#profile-header").html(n).ready(r)})})})}),$("#family_related a.edit").live("click",function(n){n.preventDefault(),$("<div class='modal fade hide' />").load($(this).attr("href"),{},function(){var n=$(this);n.modal("show");n.on("shown",function(){n.find("textarea").focus()});n.on("hidden",function(){$(this).remove()});n.on("click","a.save",function(t){t.preventDefault(),$.post($(this).attr("href"),{value:n.find("textarea").val()},function(t){$("#related-families-div").html(t),n.modal("hide")})});n.on("click","a.delete",function(t){t.preventDefault();var i=$(this);return bootbox.confirm("Are you sure you want to remove this relationship?",function(t){t===!0&&$.post(i.attr("href"),{},function(t){$("#related-families-div").html(t),n.modal("hide")})}),!1})})}),$("form.ajax a.membertype").live("click",function(n){n.preventDefault(),$("#member-dialog").css({"margin-top":"",top:""}).load($(this).attr("href"),{},function(){$(this).modal("show");$(this).on("hidden",function(){$(this).empty()})})});$('a[data-toggle="tab"]').on("shown",function(n){n.preventDefault();var t=$(n.target).attr("href").replace("#","#tab-");return window.location.hash=t,$.cookie("lasttab",t),!1});n=$.cookie("lasttab"),window.location.hash&&(n=window.location.hash),n&&(t=$("a[href='"+n.replace("tab-","")+"']"),i=t.closest("ul").data("tabparent"),i&&$("a[href='#"+i+"']").click().tab("show"),$.cookie("lasttab",t.attr("href")),t.click().tab("show"));$("a[href='#enrollment']").on("shown",function(){$("#current").length<2&&$("a[href='#current']").click().tab("show")});$("a[href='#profile']").on("shown",function(){var n="#memberstatus";$(n).length<2&&($("a[href='"+n+"']").click().tab("show"),$.cookie("lasttab",n))});$("a[href='#ministry']").on("shown",function(){var n="#contactsreceived";$(n).length<2&&($("a[href='"+n+"']").click().tab("show"),$.cookie("lasttab",n))});$("a[href='#giving']").on("shown",function(){var n="#contributions";$(n).length<2&&($("a[href='"+n+"']").click().tab("show"),$.cookie("lasttab",n))});$("a[href='#emails']").on("shown",function(){var n="#receivedemails";$(n).length<2&&($("a[href='"+n+"']").click().tab("show"),$.cookie("lasttab",n))});$("a[href='#system']").on("shown",function(){var n="#user";$(n).length<2&&($("a[href='"+n+"']").click().tab("show"),$.cookie("lasttab",n))});$.validator.addMethod("ValidDate",function(n,t){var i=$.DateValid(n);return this.optional(t)||i},"Please enter valid date"),$("#future").live("click",function(n){n.preventDefault();var t=$(this).closest("div.loaded"),i=t.find("form").serialize();$.post($("#FutureLink").val(),i,function(n){t.html(n)})}),$("#addrf").validate(),$("#addrp").validate(),$("#basic").validate();$("body").on("change",".atck",function(){var n=$(this);$.post("/Meeting/MarkAttendance/",{MeetingId:$(this).attr("mid"),PeopleId:$(this).attr("pid"),Present:n.is(":checked")},function(t){if(t.error)n.attr("checked",!n.is(":checked")),alert(t.error);else{var i=n.closest("form"),r=i.serialize();$.post($(i).attr("action"),r,function(n){$(i).html(n)})}})});$("#vtab>ul>li").click(function(){$("#vtab>ul>li").removeClass("selected"),$(this).addClass("selected");var n=$("#vtab>ul>li").index($(this));$("#vtab>div").hide().eq(n).show()});$("body").on("click",function(n){$("[rel=popover]").each(function(){$(this).is(n.target)||$(this).has(n.target).length!==0||$(".popover").has(n.target).length!==0||$(this).popover("hide")})});u=function(n){var t="https://maps.googleapis.com/maps/api/staticmap?",r=$.extend({center:"New York, NY",size:"128x128",sensor:!1},n),i=[];return $.each(r,function(n,t){i.push(n+"="+encodeURIComponent(t))}),t+=i.join("&"),'<img src="'+t+'" /><br><a href="https://www.google.com/maps/?q='+n.center+'" rel="external" target="_blank">View in Google Maps<\/a>      <br><a href="http://www.bing.com/maps/?q='+n.center+'" rel="external" target="_blank">View in Bing Maps<\/a>'},r=function(){$('[class="popover-map"]').each(function(){var n=$(this);n.data("html",!0).data("content",u({center:n.text()})),n.popover()}),$("#PositionInFamily").editable({source:[{value:10,text:"Primary Adult"},{value:20,text:"Secondary Adult"},{value:30,text:"Child"}],type:"select",url:"/Person2/PostData",name:"position"}),$("#Campus").editable({source:"/Person2/Campuses",type:"select",url:"/Person2/PostData",name:"campus"})},r(),$.InitFunctions.Editable=function(){$("a.editable").editable()},$("a.click-pencil").live("click",function(n){return n.stopPropagation(),$(this).prev().editable("toggle"),!1}),$.InitFunctions.MemberDocsEditable=function(){$("#memberdocs-form a.editable").editable({placement:"right",showbuttons:"bottom"})}});